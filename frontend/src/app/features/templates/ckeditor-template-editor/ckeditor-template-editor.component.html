<div class="editor-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        {{ isEditMode ? 'Edit' : 'Create' }} Certificate Template
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="templateForm">
        <!-- Template Name -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Template Name</mat-label>
          <input matInput formControlName="name" placeholder="e.g., Course Completion Certificate">
          <mat-error *ngIf="templateForm.get('name')?.hasError('required')">
            Template name is required
          </mat-error>
        </mat-form-field>

        <!-- Template Description -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description</mat-label>
          <textarea 
            matInput 
            formControlName="description" 
            rows="2"
            placeholder="Brief description of this template"></textarea>
        </mat-form-field>

        <!-- Placeholder Helper Section -->
        <div class="placeholder-section">
          <h3>Available Placeholders</h3>
          <p class="helper-text">
            Click to insert placeholders into your certificate. You can also type them manually using the format: <code>{{'{{'}}placeholder_name{{'}}'}}</code>
          </p>
          
          <div class="placeholder-chips">
            <mat-chip-set>
              <mat-chip 
                *ngFor="let placeholder of suggestedPlaceholders"
                (click)="insertPlaceholder(placeholder)"
                class="placeholder-chip">
                <mat-icon>add</mat-icon>
                {{'{{'}}{{ placeholder }}{{'}}'}}
              </mat-chip>
            </mat-chip-set>
          </div>

          <!-- Detected Placeholders -->
          <div *ngIf="extractedPlaceholders.length > 0" class="detected-placeholders">
            <h4>Detected Placeholders in Template:</h4>
            <mat-chip-set>
              <mat-chip *ngFor="let placeholder of extractedPlaceholders" class="detected-chip">
                {{'{{'}}{{ placeholder }}{{'}}'}}
              </mat-chip>
            </mat-chip-set>
          </div>
        </div>

        <!-- CKEditor -->
        <div class="editor-wrapper">
          <h3>Certificate Design</h3>
          <p class="helper-text">
            Design your certificate using the rich text editor. Use the toolbar to add colors, borders, fonts, images, and styling.
          </p>
          
          <ckeditor
            [editor]="Editor"
            [(ngModel)]="editorContent"
            [config]="editorConfig"
            (change)="onEditorChange($event)"
            [ngModelOptions]="{standalone: true}">
          </ckeditor>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button 
            mat-raised-button 
            color="primary" 
            (click)="saveTemplate()"
            [disabled]="isLoading || templateForm.invalid">
            <mat-icon>save</mat-icon>
            {{ isEditMode ? 'Update' : 'Save' }} Template
          </button>

          <button 
            mat-raised-button 
            color="accent" 
            (click)="previewTemplate()"
            [disabled]="isLoading || !editorContent">
            <mat-icon>preview</mat-icon>
            Preview & Simulate
          </button>

          <button 
            mat-stroked-button 
            (click)="cancel()"
            [disabled]="isLoading">
            <mat-icon>cancel</mat-icon>
            Cancel
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
